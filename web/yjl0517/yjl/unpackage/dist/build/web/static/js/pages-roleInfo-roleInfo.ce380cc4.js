(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-roleInfo-roleInfo"],{"28ee":function(e,t,n){"use strict";n.r(t);var o=n("df98"),a=n("c440");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("c5c8");var r=n("828b"),s=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,"bc574e1e",null,!1,o["a"],void 0);t["default"]=s.exports},4988:function(e,t,n){"use strict";n("6a54");var o=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("9b1b"));n("fd3c"),n("64aa"),n("8f71"),n("bf0f"),n("5ef2");var i=n("03c2"),r=n("7e7d"),s={data:function(){return{menuList:[],menuList2:[],roleFrom:{roleName:"",description:"",menuIds:[]},roleId:"",checkNumberInArray:r.checkNumberInArray,permissionList:[]}},computed:{loginUser:function(){return this.$store.state.loginUser},menu:function(){return this.$store.state.menu}},methods:{showDel:function(){this.$refs.alertDel.open()},showEdit:function(){this.$refs.alertEdit.open()},getMenu:function(){var e=this;(0,i.getMenuList)({pageNum:1,pageSize:999}).then((function(t){console.log(t.data.data),200==t.data.code&&(e.menuList=(0,r.arrToTree)(t.data.data.list,0),e.menuList2=t.data.data.list,console.log("转化成=>"),console.log(e.menuList))}))},getPermission:function(){var e=this;(0,i.getPermissionById)().then((function(t){200==t.data.code&&(e.permissionList=t.data.data.map((function(e){return{text:e.permission_name,value:e.permission_id}})),console.log("数据权限",e.permissionList))}))},saveUser:function(){console.log(this.roleFrom.menuIds),console.log(this.roleFrom.permissionIds);var e={};e=(0,a.default)({},this.roleFrom);var t=this.roleFrom.menuIds.join(",");e.menuIds=t,(0,i.setRoleInfo)(e).then((function(e){console.log(e),200==e.data.code?(uni.showToast({title:"保存成功"}),uni.navigateBack()):uni.showToast({icon:"error",title:e.data.msg})}))},delUser:function(){(0,i.delRoleInfo)({ids:this.roleFrom.roleId}).then((function(e){console.log(e),200==e.data.code?(uni.showToast({title:"删除成功"}),uni.navigateBack()):uni.showToast({icon:"error",title:e.data.msg})}))},dialogClose:function(){console.log("点击关闭")},queryRole:function(){var e=this;(0,i.getRoleList)({pageNum:1,pageSize:20,roleId:this.roleId}).then((function(t){if(console.log(t.data.data),200==t.data.code){var n,o,i=(0,a.default)({},t.data.data.list[0]);if(i.menuIds&&(n=i.menuIds.split(","),o=n.map(Number),o=o.filter((function(e,t,n){return n.indexOf(e)===t})),i.menuIds=o),i.permissions&&!i.permissionIds){var r;r=i.permissions.map((function(e){return e.permission_id})),i.permissionIds=r}e.roleFrom=i,console.log(e.roleFrom.menuIds)}else uni.showToast({icon:"error",title:t.data.msg?t.data.msg:"网络出现问题,请重试"})}))}},onLoad:function(e){this.roleId=e.roleId},onShow:function(){this.getMenu(),this.queryRole(),this.getPermission()}};t.default=s},"5eae":function(e,t,n){var o=n("7848");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var a=n("967d").default;a("771a9f3a",o,!0,{sourceMap:!1,shadowMode:!1})},7848:function(e,t,n){var o=n("c86c");t=o(!1),t.push([e.i,".container[data-v-bc574e1e]{\n\t/* background: url() cover; */display:flex;flex-direction:column;align-items:center;\n\t/* background:linear-gradient(180deg,#689DB1 0%,#F0F0F3 100%); */width:%?750?%;overflow-x:hidden;min-height:96vh;font-family:alyuan}.roleFrom[data-v-bc574e1e]{margin:%?25?%;width:%?660?%;background:#fff;border-radius:%?25?%;box-shadow:%?5?% %?5?% %?5?% #ccc;margin:%?15?% auto;padding:%?20?%;margin-top:%?15?%\n\t/* border: #06BFF7 5rpx solid;\n\tbox-shadow: 0 0 25px rgb(0, 106, 255) inset;\n\tcolor: #fff; */}.BtnGroup[data-v-bc574e1e]{margin-top:%?35?%}.BtnGroup .btn[data-v-bc574e1e]{margin-top:%?20?%}.input[data-v-bc574e1e]{border-radius:%?15?%}.from .btn[data-v-bc574e1e]{width:%?650?%}",""]),e.exports=t},c440:function(e,t,n){"use strict";n.r(t);var o=n("4988"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},c5c8:function(e,t,n){"use strict";var o=n("5eae"),a=n.n(o);a.a},df98:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uniForms:n("1a6d").default,uniFormsItem:n("e081").default,uniEasyinput:n("9ccf").default,customTreeSelect:n("f2dd").default,uniPopup:n("7822").default,uniPopupDialog:n("eb8c").default},a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"container"},[n("v-uni-view",{staticClass:"roleFrom"},[n("uni-forms",{ref:"roleFrom",attrs:{modelValue:e.roleFrom}},[n("uni-forms-item",{attrs:{label:"身份名称",name:"roleName","label-width":"250"}},[n("uni-easyinput",{staticClass:"input",attrs:{placeholder:"请输入身份名称"},model:{value:e.roleFrom.roleName,callback:function(t){e.$set(e.roleFrom,"roleName",t)},expression:"roleFrom.roleName"}})],1),n("uni-forms-item",{attrs:{label:"身份描述",name:"description","label-width":"250"}},[n("uni-easyinput",{staticClass:"input",attrs:{type:"textarea",autoHeight:!0,placeholder:"请输入身份描述"},model:{value:e.roleFrom.description,callback:function(t){e.$set(e.roleFrom,"description",t)},expression:"roleFrom.description"}})],1),n("uni-forms-item",{attrs:{label:"身份权限",name:"roleName","label-width":"250"}},[n("custom-tree-select",{staticClass:"input",attrs:{listData:e.menuList,dataLabel:"menuName",dataValue:"menuId",dataChildren:"children",mutiple:!0,linkage:!0},model:{value:e.roleFrom.menuIds,callback:function(t){e.$set(e.roleFrom,"menuIds",t)},expression:"roleFrom.menuIds"}})],1),n("uni-forms-item",{attrs:{label:"数据权限",name:"roleName","label-width":"250"}},[n("custom-tree-select",{staticClass:"input",attrs:{listData:e.permissionList,dataLabel:"text",dataValue:"value",dataChildren:"children",mutiple:!0,linkage:!0},model:{value:e.roleFrom.permissionIds,callback:function(t){e.$set(e.roleFrom,"permissionIds",t)},expression:"roleFrom.permissionIds"}})],1)],1),n("v-uni-view",{staticClass:"BtnGroup"},[e.checkNumberInArray(e.menu,"28")?n("v-uni-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.showEdit()}}},[e._v("保存修改")]):e._e(),e.checkNumberInArray(e.menu,"29")?n("v-uni-button",{staticClass:"btn",attrs:{type:"error"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.showDel()}}},[e._v("删除角色")]):e._e()],1),n("uni-popup",{ref:"alertDel",attrs:{type:"dialog"}},[n("uni-popup-dialog",{attrs:{type:"info",cancelText:"取消",confirmText:"确认",title:"通知",content:"确认删除角色吗?"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.delUser()},close:function(t){arguments[0]=t=e.$handleEvent(t),e.dialogClose.apply(void 0,arguments)}}})],1),n("uni-popup",{ref:"alertEdit",attrs:{type:"dialog"}},[n("uni-popup-dialog",{attrs:{type:"success",cancelText:"取消",confirmText:"确认",title:"通知",content:"确认保存角色信息?"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.saveUser()},close:function(t){arguments[0]=t=e.$handleEvent(t),e.dialogClose.apply(void 0,arguments)}}})],1)],1)],1)},i=[]}}]);